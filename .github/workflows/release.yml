# pushæ™‚ã« Prism Launcher ç”¨ã®èµ·å‹•æ§‹æˆzipã‚’è‡ªå‹•ç”Ÿæˆ
name: Build and Release

on:
  push:
    branches: [main]
    paths:
      - 'mods/**'
      - 'gunpacks/**'
      - 'jars/**'
      - 'config/**'
      - 'pack.toml'
      - 'index.toml'
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Download packwiz-installer-bootstrap
        run: |
          curl -sL -o packwiz-installer-bootstrap.jar \
            https://github.com/packwiz/packwiz-installer-bootstrap/releases/latest/download/packwiz-installer-bootstrap.jar
      
      - name: Create Prism Launcher instance
        run: |
          mkdir -p instance/.minecraft
          mkdir -p instance
          
          # packwiz-installer-bootstrap.jar ã‚’é…ç½®
          cp packwiz-installer-bootstrap.jar instance/.minecraft/
          
          # Prism Launcher ã® instance.cfg ã‚’ä½œæˆï¼ˆãƒ¡ãƒ¢ãƒªè¨­å®šè¾¼ã¿ï¼‰
          cat > instance/instance.cfg << 'EOF'
          InstanceType=OneSix
          JavaVersion=17
          LogPrePostOutput=true
          ManagedPack=false
          ManagedPackID=
          ManagedPackName=
          ManagedPackType=
          ManagedPackVersionID=
          ManagedPackVersionName=
          OverrideCommands=true
          OverrideMemory=true
          MinMemAlloc=2048
          MaxMemAlloc=6144
          PreLaunchCommand="$INST_JAVA" -jar packwiz-installer-bootstrap.jar -g -s client https://raw.githubusercontent.com/tekitounix/minecraft-modpack/main/pack.toml
          name=Modpack Server
          EOF
          
          # mmc-pack.json ã‚’ä½œæˆï¼ˆForge 47.4.0 æŒ‡å®šï¼‰
          cat > instance/mmc-pack.json << 'EOF'
          {
            "components": [
              {
                "uid": "net.minecraft",
                "version": "1.20.1"
              },
              {
                "uid": "net.minecraftforge",
                "version": "47.4.0"
              }
            ],
            "formatVersion": 1
          }
          EOF
      
      - name: Create zip
        run: |
          cd instance
          zip -r ../modpack-prism.zip .
          cd ..
      
      - name: Get current date
        id: date
        run: echo "date=$(date +'%Y%m%d-%H%M')" >> $GITHUB_OUTPUT
      
      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: v${{ steps.date.outputs.date }}
          name: Modpack ${{ steps.date.outputs.date }}
          body: |
            ## ğŸ® Modpack æ›´æ–°
            
            ### ğŸ“¥ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•
            
            1. **[Hamachi](https://vpn.net/)** ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å‚åŠ ï¼ˆã‚µãƒ¼ãƒãƒ¼ç®¡ç†è€…ã‹ã‚‰æƒ…å ±ã‚’å—ã‘å–ã‚‹ï¼‰
            2. **[Prism Launcher](https://prismlauncher.org/download/)** ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
            3. Prism Launcher ã§ **ã€Œèµ·å‹•æ§‹æˆã‚’è¿½åŠ ã€** â†’ **ã€Œã‚¤ãƒ³ãƒãƒ¼ãƒˆã€**
            4. **ã€Œãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‘ã‚¹ã¾ãŸã¯ç›´ãƒªãƒ³ã‚¯ã€** ã«ä»¥ä¸‹ã® URL ã‚’å…¥åŠ›ï¼š
               ```
               https://github.com/tekitounix/minecraft-modpack/releases/latest/download/modpack-prism.zip
               ```
            5. **ã€ŒOKã€** ã‚’ã‚¯ãƒªãƒƒã‚¯
            6. èµ·å‹•ã—ã¦ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šï¼ï¼ˆIP ã¯ã‚µãƒ¼ãƒãƒ¼ç®¡ç†è€…ã«ç¢ºèªï¼‰
            
            > ğŸ‡ºğŸ‡¸ English UI: **Add Instance** â†’ **Import** â†’ Paste URL in **"Local file or link to a direct download"** â†’ **OK**
            
            âœ… **ãƒ¡ãƒ¢ãƒªè¨­å®šï¼ˆ6GBï¼‰ã¯è‡ªå‹•é©ç”¨æ¸ˆã¿**
            âœ… **åˆå›èµ·å‹•æ™‚ã«å…¨ã¦ã® Mod ã¨ TaCZ éŠƒãƒ‘ãƒƒã‚¯ãŒè‡ªå‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**
            
            ğŸ“– è©³ç´°ã¯ [README](https://github.com/tekitounix/minecraft-modpack#readme) ã‚’å‚ç…§
          files: modpack-prism.zip
          draft: false
          prerelease: false
